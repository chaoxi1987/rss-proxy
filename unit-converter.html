<!-- 单位换算计算器 开始 -->
<style>
    /* 计算器容器 - 保持与主题一致 */
    .converter-container {
        max-width: 100%; /* 修改: 宽度改为100%，适应小屏幕 */
        margin: 20px auto;
        background-color: #f8f9fa;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    /* 单位类型选择 */
    .unit-type-btn {
        flex: 1;
        min-width: 60px; /* 修改: 减小最小宽度 */
        padding: 8px;
        font-size: 12px; /* 修改: 减小字体大小 */
        text-align: center;
        transition: all 0.2s;
    }

    /* 转换区域 */
    .conversion-input-group {
        display: flex;
        border: 1px solid #ced4da;
        border-radius: 5px;
        overflow: hidden;
        gap: 5px; /* 修改: 增加间距，避免内容挤压 */
    }

    .conversion-input {
        flex: 1;
        padding: 10px 12px;
        font-size: 14px; /* 修改: 减小字体大小 */
    }

    /* 调整下拉菜单样式以适应小屏幕 */
    .conversion-select {
        width: 40%;
        padding: 10px;
        font-size: 14px;
        appearance: none; /* 隐藏默认箭头 */
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>') no-repeat right 10px center; /* 添加自定义箭头 */
        background-size: 16px;
    }

    /* 响应式调整 */
    @media (max-width: 576px) {
        .converter-container {
            margin: 10px;
        }
        
        .unit-type-btn {
            min-width: 50px; /* 修改: 进一步减小最小宽度 */
            font-size: 10px; /* 修改: 进一步减小字体大小 */
            padding: 6px;
        }
        
        .conversion-input {
            padding: 8px 10px;
            font-size: 12px; /* 修改: 进一步减小字体大小 */
        }
        
        .conversion-select {
            padding: 8px;
            font-size: 12px;
        }
    }
</style>

<div class="calculator-container">
    <div class="calculator-header">
        <h2>单位换算计算器</h2>
    </div>
    
    <div class="unit-type-selector">
        <button class="unit-type-btn active" data-type="length">长度</button>
        <button class="unit-type-btn" data-type="weight">重量</button>
        <button class="unit-type-btn" data-type="area">面积</button>
        <button class="unit-type-btn" data-type="volume">体积</button>
        <button class="unit-type-btn" data-type="temperature">温度</button>
    </div>
    
    <div class="conversion-area">
        <div class="conversion-group">
            <label class="conversion-label">从</label>
            <div class="conversion-input-group">
                <input type="number" class="conversion-input" id="fromValue" value="1" step="any">
                <select class="conversion-select" id="fromUnit"></select>
            </div>
        </div>
        
        <button class="swap-btn" id="swapBtn">⇅</button>
        
        <div class="conversion-group"></div>
            <label class="conversion-label">到</label>
            <div class="conversion-input-group">
                <input type="number" class="conversion-input" id="toValue" readonly>
                <select class="conversion-select" id="toUnit"></select>
            </div>
        </div>
    </div>
    
    <div class="converter-footer">
        实时换算，支持多种常用单位
        <div style="margin-top: 10px; font-size: 12px; color: #999;">
            © 2025 老登学习工具箱 - 保留所有权利
        </div>
    </div>
</div>

<script>
// 单位定义
const unitData = {
    length: {
        name: "长度",
        units: {
            mm: { name: "毫米 (mm)", factor: 0.001 },
            cm: { name: "厘米 (cm)", factor: 0.01 },
            m: { name: "米 (m)", factor: 1 },
            km: { name: "千米 (km)", factor: 1000 },
            inch: { name: "英寸 (in)", factor: 0.0254 },
            ft: { name: "英尺 (ft)", factor: 0.3048 },
            yd: { name: "码 (yd)", factor: 0.9144 },
            mile: { name: "英里 (mi)", factor: 1609.344 }
        },
        defaultFrom: "cm",
        defaultTo: "m"
    },
    weight: {
        name: "重量",
        units: {
            mg: { name: "毫克 (mg)", factor: 0.000001 },
            g: { name: "克 (g)", factor: 0.001 },
            kg: { name: "千克 (kg)", factor: 1 },
            t: { name: "吨 (t)", factor: 1000 },
            oz: { name: "盎司 (oz)", factor: 0.02835 },
            lb: { name: "磅 (lb)", factor: 0.45359 }
        },
        defaultFrom: "g",
        defaultTo: "kg"
    },
    area: {
        name: "面积",
        units: {
            mm2: { name: "平方毫米 (mm²)", factor: 0.000001 },
            cm2: { name: "平方厘米 (cm²)", factor: 0.0001 },
            m2: { name: "平方米 (m²)", factor: 1 },
            km2: { name: "平方千米 (km²)", factor: 1000000 },
            acre: { name: "英亩 (acre)", factor: 4046.86 }
        },
        defaultFrom: "cm2",
        defaultTo: "m2"
    },
    volume: {
        name: "体积",
        units: {
            ml: { name: "毫升 (ml)", factor: 0.001 },
            l: { name: "升 (l)", factor: 1 },
            m3: { name: "立方米 (m³)", factor: 1000 },
            gal: { name: "加仑 (gal)", factor: 3.78541 }
        },
        defaultFrom: "ml",
        defaultTo: "l"
    },
    temperature: {
        name: "温度",
        units: {
            c: { name: "摄氏度 (°C)", factor: 1 },
            f: { name: "华氏度 (°F)", factor: 1 },
            k: { name: "开尔文 (K)", factor: 1 }
        },
        defaultFrom: "c",
        defaultTo: "f"
    }
};

// 初始化计算器
document.addEventListener('DOMContentLoaded', function() {
    const typeButtons = document.querySelectorAll('.unit-type-btn');
    const fromValueInput = document.getElementById('fromValue');
    const toValueInput = document.getElementById('toValue');
    const fromUnitSelect = document.getElementById('fromUnit');
    const toUnitSelect = document.getElementById('toUnit');
    const swapButton = document.getElementById('swapBtn');
    
    let currentType = 'length';
    
    // 初始化单位类型选择
    typeButtons.forEach(button => {
        button.addEventListener('click', function() {
            typeButtons.forEach(btn => btn.classList.remove('active'));
            this.classList.add('active');
            currentType = this.dataset.type;
            updateUnitSelects();
            convert();
        });
    });
    
    // 更新单位选择下拉框
    function updateUnitSelects() {
        const units = unitData[currentType].units;
        
        fromUnitSelect.innerHTML = '';
        toUnitSelect.innerHTML = '';
        
        for (const [code, unit] of Object.entries(units)) {
            const fromOption = document.createElement('option');
            fromOption.value = code;
            fromOption.textContent = unit.name;
            fromUnitSelect.appendChild(fromOption);
            
            const toOption = document.createElement('option');
            toOption.value = code;
            toOption.textContent = unit.name;
            toUnitSelect.appendChild(toOption);
        }
        
        // 设置默认单位
        fromUnitSelect.value = unitData[currentType].defaultFrom;
        toUnitSelect.value = unitData[currentType].defaultTo;
    }
    
    // 执行单位转换
    function convert() {
        const fromValue = parseFloat(fromValueInput.value);
        const fromUnit = fromUnitSelect.value;
        const toUnit = toUnitSelect.value;
        
        if (isNaN(fromValue)) {
            toValueInput.value = '';
            return;
        }
        
        let result;
        
        // 温度转换需要特殊处理
        if (currentType === 'temperature') {
            result = convertTemperature(fromValue, fromUnit, toUnit);
        } else {
            // 其他单位使用转换因子
            const fromFactor = unitData[currentType].units[fromUnit].factor;
            const toFactor = unitData[currentType].units[toUnit].factor;
            result = (fromValue * fromFactor) / toFactor;
        }
        
        // 格式化结果
        toValueInput.value = formatResult(result);
    }
    
    // 温度转换函数
    function convertTemperature(value, fromUnit, toUnit) {
        // 先转换为摄氏度
        let celsius;
        if (fromUnit === 'c') {
            celsius = value;
        } else if (fromUnit === 'f') {
            celsius = (value - 32) * 5/9;
        } else if (fromUnit === 'k') {
            celsius = value - 273.15;
        }
        
        // 从摄氏度转换为目标单位
        if (toUnit === 'c') {
            return celsius;
        } else if (toUnit === 'f') {
            return celsius * 9/5 + 32;
        } else if (toUnit === 'k') {
            return celsius + 273.15;
        }
    }
    
    // 格式化结果
    function formatResult(value) {
        if (isNaN(value)) return '';
        
        // 根据数值大小选择合适的显示格式
        if (Math.abs(value) >= 1000) {
            return value.toFixed(2);
        } else if (Math.abs(value) >= 100) {
            return value.toFixed(3);
        } else if (Math.abs(value) >= 10) {
            return value.toFixed(4);
        } else if (Math.abs(value) >= 1) {
            return value.toFixed(5);
        } else if (Math.abs(value) >= 0.01) {
            return value.toFixed(6);
        } else {
            return value.toExponential(4);
        }
    }
    
    // 交换单位
    function swapUnits() {
        const tempUnit = fromUnitSelect.value;
        fromUnitSelect.value = toUnitSelect.value;
        toUnitSelect.value = tempUnit;
        convert();
    }
    
    // 事件监听
    fromValueInput.addEventListener('input', convert);
    fromUnitSelect.addEventListener('change', convert);
    toUnitSelect.addEventListener('change', convert);
    swapButton.addEventListener('click', swapUnits);
    
    // 初始化
    updateUnitSelects();
    convert();
});

// 确保下拉菜单的点击事件能够正确触发
document.addEventListener('DOMContentLoaded', function() {
    const fromUnitSelect = document.getElementById('fromUnit');
    const toUnitSelect = document.getElementById('toUnit');

    // 修复下拉菜单的点击事件
    fromUnitSelect.addEventListener('click', function(event) {
        event.stopPropagation(); // 阻止事件冒泡
    });

    toUnitSelect.addEventListener('click', function(event) {
        event.stopPropagation(); // 阻止事件冒泡
    });
});
</script>
<!-- 单位换算计算器 结束 -->